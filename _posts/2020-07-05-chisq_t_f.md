---
title: 'Chi Square, T, F Distribution'
date: 2020-07-05
permalink: /posts/2020/07/05/chisq_t_f
category:
  - posts
---

<iframe src="https://www.youtube.com/embed/DyBxYsCow9k"> </iframe>

## Chi-Square Distribution
- iid인 표준 정규 분포가 n개 있다.($Z_1, Z_2, ..., Z_n$)

- $Z=Z_1^2+ Z_2^2+ ...+ Z_n^2$는 카이제곱 분포를 따른다.

- $Z\sim \chi^2(v)$

- 파라미터인 $v$는 자유도를 뜻하며, 카이제곱 분포를 형성할 때 더한 표준 정규 분포의 갯수를 뜻한다.

- 카이제곱 분포의 PDF

![](https://user-images.githubusercontent.com/26649034/86525674-3e395180-bec5-11ea-9a1c-78a13c8d4c3a.png)

- $E[X]=v,\;V[X]=2v$

- $\alpha=v/2, \lambda=2$인 특별한 형태의 감마분포이다.

- 표준 정규 분포가 표준 정규 분포표를 가지고 있듯이, 카이제곱 분포도 카이제곱 분포표를 가지고 있다.

## Sampling Distribution of Sample Variance
1. $\mu$는 모평균이다. 
$\chi^2(n)=\sum_{i=1}^{n}(X_i-\mu)^2/\sigma^2$  

3. $\bar{X}$는 표본 평균이다. 표본 평균으로 추정을 했으므로 알고 있는 것이다. 그래서 $n$개 중에서 하나(표본 평균)는 이미 정해진 값이고, 나머지 $n-1$개는 자유롭게 정해질 수 있는 값이다. 그래서 자유도가 $n-1$이다.
$\chi^2(n-1)=\sum_{i=1}^{n}(X_i-\bar{X})^2/\sigma^2$

## 자유도(보충설명)
- 자유도를 명확하게 배우기는 쉽지 않다.

- 많이 접하면서 감을 잡을 수 밖에 없다.

### 예시  
- $X_1=2, X_2=3, X_3=4, X_4=5, X_5=?$

- $\sum_{i=1}^{5}X_i=20$

위 두 조건을 만족할 때, $X_5$는 얼마인가?

$\sum_{i=1}^{4}X_i=14$이므로 $X_5$는 6이 될 수 밖에 없다.

이 문제에서 자유도는 얼마일까?

문제에서 자유롭게 정해질 수 있는 값은 $X_1, X_2, X_3, X_4$이며, $X_5$는 나머지 값들에게 종속된다. 그러므로 자유도는 4이다.

## Sampling Distribution of Sample Variance - Example
$N(\mu=15,\mu^2=100)$인 모집단으로부터 독립적이고 동일하게(iid) 25개의 샘플을 뽑았다($X_1, X_2, ..., X_{25}$). 이 때 $Y=(n-1)S^2/\sigma^2$는 $\chi^2(24)$를 따른다(자유도는 24). 즉, $P[Y>\chi^2_{\alpha,24}]=\alpha$라고 할 수 있다.

$P[S^2>c]=0.95$일 때 c의 값을 구하라.

$S^2$의 분포를 바로 파악하기 힘드므로 양 변에 $(n-1)$을 곱하고, $\sigma^2$으로 나눈다. 즉, $P[(n-1)S^2/\sigma^2>(n-1)c/\sigma^2]=0.95$을 만족하는 c를 찾으면 된다. 

$P[Y>24c/100]=0.95$  

카이제곱 분포표에서 $n$ 24이고, $\alpha$가 0.95인 것을 찾으면 $24c/100=13.848$이 된다. $c=57.7$

## t Distribution
- $Z\sim N(0,1)$  

- $Y\sim \chi^2(v)$  

- $$T={Z\over\sqrt{Y/v}}$$

- $T$ 통계량은 자유도가 $v$인 t-분포(t-distribution)를 따른다.($t(v)$로 표기)

- 카이제곱 분포의 자유도가 그대로 t-분포의 자유도가 된다.

- t-분포의 기댓값은 0이고, 이를 기준으로 좌우 대칭이다.

- 표준정규분포보다 긴 꼬리를 가지고 있다.

- 기댓값을 기준으로 좌우 대칭이라는 특성 때문에 아래 수식을 만족한다.
$P[T<-t_{\alpha, v}]=P[T>t_{\alpha, v}]=\alpha$  

![](https://user-images.githubusercontent.com/26649034/86525673-3d082480-bec5-11ea-8154-a9d041a0a4df.png)

오른쪽 그림에서 알 수 있듯이 표준 정규 분포보다 긴 꼬리를 가지고 있다.

왼쪽 그림에서 알 수 있듯이 자유도가 작을수록 긴 꼬리를 가진다.

### t-분포 조금 더 자세히
- $N(\mu,\sigma^2)$에서 표본 $n$개를 추출한다($X_1, X_2, ..., X_n$).

- $Z=\bar{X}-\mu/(\sigma/\sqrt{n})$이므로 $N(0,1)$을 따른다.

- $Y=(n-1)S^2/\sigma^2$이므로 $\chi^2(n-1)$을 따른다.

- $$T={Z\over\sqrt{Y/v}}={\bar{X}-\mu/(\sigma/\sqrt{n})\over\sqrt{((n-1)S^2/\sigma^2)/(n-1)}}={\bar{X}-\mu\over S/\sqrt{n}}$$

- 이 때, $T$는 자유도가 $n-1$인 t-분포를 따른다.($T\sim t(n-1)$)

- 신기하게도 $T$ 통계량과 표준 정규 분포는 매우 닮았다. 다른 점이 있다면 표준 정규 분포에서는 $\sigma$(모표준편차)가 사용되고, $T$ 통계량에서는 $S$(표본표준편차)가 사용된다는 점이다.

- 그래서 모집단의 표준편차를 알고 있을 때는 표준 정규 분포로 표현하면 되고, 모집단의 표준 편차를 모른다면 t-분포로 표현하면 된다.

## t Distribution - Example
$N(\mu=15,\mu^2=100)$인 모집단으로부터 독립적이고 동일하게(iid) 25개의 샘플을 뽑았다($X_1, X_2, ..., X_{25}$).

$T={\bar{X}-\mu\over S/\sqrt{n}}$이고, 이는 $t(v=24)$를 따른다.

$P[T<-t_{\alpha, 24}]=P[T>t_{\alpha, 24}]=\alpha$

$P[T < c]=0.05$인 $c$를 구하라.

$t$분포 테이블에서 자유도가 24이고, $\alpha$가 0.05인 것을 찾으면 1.711이다. $c$보다 작을 확률이므로 $c=-1.711$이 된다.

## F Distribution
- $Y_1=\chi^2(v_1)$  

- $Y_2=\chi^2(v_2)$  

- $$F={Y_1/v_1\over Y_2/v_2}$$

- 이렇게 정의되는 것을 F통계량이라고 하고, 이는 F 분포를 따른다. F분포는 $v_1, v_2$ 두 개의 자유도를 가지며, $F(v_1, v_2)$로 표기한다.

- F 테이블이 있어 확률값을 쉽게 구할 수 있다.

- $P[F>f_a(v_1,v_2)]=f_{1-\alpha}(v_1, v_2)={1\over f_{\alpha}(v_2,v_1)}$  

![](https://user-images.githubusercontent.com/26649034/86525671-39749d80-bec5-11ea-9663-a8bc3cacb227.png)

## F Distribution - Example
- 모집단 1 : $N(\mu_1=4,\sigma_1^2=16)$  

- 모집단 2 : $N(\mu_2=12,\sigma_2^2=48)$  

모집단 1로부터 동일하고 독립적인 $n_1=15$개의 샘플을 추출하고, 모집단 2로부터 동일하고 독립적인 $n_2=10$개의 샘플을 추출한다.

$F={S_1^2/\sigma_1^2\over S_2^2/\sigma_2^2}$는 $F(14,9)$를 따른다.

이 때 $P[S_1^2/S_2^2\le c]=0.05$일 때, c를 구하라.

$P[S_1^2/S_2^2\le c]=P[S_1^2\sigma_2^2/S_2^2\sigma_1^2\le (\sigma_2^2/\sigma_1^2)c]=P(F<3c)=0.05$  

$P[F>f_{0.95}(14,9)]=0.95$  

$P[F\le f_{0.95}(14,9)]=0.05$  

$3c=f_{0.95}(14,9)=1/f_{0.05}(9,14)=1/2.65$  

$c=0.1258$  