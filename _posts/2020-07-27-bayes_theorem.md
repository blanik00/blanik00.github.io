---
title: 'Bayes Theroem'
date: 2020-07-27
permalink: /posts/2020/07/27/bayes_theorem
category:
  - posts
---

# 베이즈 정리(Bayes Theorem)
머신러닝을 공부하면서 베이즈 정리에 대해 각잡고 정리한 적이 없었다. 여러 리소스에서 나오는 내용들을 보며 파편적으로 베이즈 정리를 이해하고 있었다. 그런데 베이즈 정리라는게 참 특이하게 자료마다 다르게 설명한다. 크게 두 가지 정도 설명이 기억이 난다.

1  

> $P(B\|A)$를 구하는 것이 불가능할 때, $P(A\|B)$와 $P(B)$를 활용하여 $P(B\|A)$를 구하기 위한 것
>
> 한양대학교 이상화 교수님 확률 및 통계 수업 1강

2  

> 우리가 가지는 견해(예를 들어, 북극의 얼음은 a속도로 녹는다)에 관측 데이터를 추가하여 우리의 견해를 수정해나갈 수 있도록 해주는 것
>
> PRML

위 두 내용이 같은 개념을 설명하기 위한 것임을 이해하기는 쉽지 않다. 그래서 베이즈 정리는 볼 때 마다 새롭고, 처음 보는 기분이 들었다.

이런 애매모호함을 타파하기 위해 베이즈 정리를 정리해봤다.

---

베이즈 정리는 **사후확률(posterior probability)을 사전확률(prior probability)과 likelihood를 이용해서 계산할 수 있도록 해주는 확률 변환식**이다.

수식으로 표현하면 다음과 같다.

$$P(Y|X)={P(X|Y)P(Y)\over P(X)}$$

- $P(Y\|X)$ : 사후확률. 사건이 발생한 후 그 사건이 특정 모델에서 발생했을 확률
- $P(X\|Y)$ : likelihood. 어떤 모델에서 해당 데이터(관측치)가 나올 확률
- $P(Y)$ : 사전확률. 관측자가 관측을 하기 전에 시스템 또는 모델에 대해 가지고 있는 선험적 확률

---

베이즈 정리를 이해했고, 나를 헷갈리게 했던 두 가지 설명도 명확히 이해했는지 확인하기 위해 예를 들어 보자.

당신은 압정을 던져 어떤 면이 나오는지 맞추는 도박에 참가하였다. 이 도박에서 이기기 위해서는 앞면이 나올 확률을 정확히 파악해야 한다. 당신은 믿을만한 도박 전문가로부터 앞, 뒤가 나올 확률은 동등하게 0.5라는 조언을 얻었으며, 5회의 실험을 통해 앞면이 3번 나왔고, 뒷면이 2번 나왔다. 이 때, 앞면이 나올 확률은 얼마인가?

우리가 구하고자 하는 것은 앞면이 나올 확률인 $\theta$다. 도박 전문가에게 얻은 조언은 사전확률이라고 할 수 있으며, 실험 $D$의 결과로 likelihood를 계산해낼 수 있다. 이 두 가지 정보를 바탕으로 우리는 사후확률 $P(\theta\|D)$를 계산할 수 있다.

1번 설명은 앞면이 나올 확률인 $\theta$를 알 수 없으니 관측을 통한 결과로부터 likelihood를 구하고, 도박 전문가로부터 조언을 얻어(사전확률) $\theta$를 계산해낼 수 있다는 내용이다.

2번 설명은 사전확률에 조금 더 초점을 맞춰 설명한다. 도박 전문가에게 앞면이 나올 확률(사전확률)이 0.5라는 조언을 얻었지만 이 내용을 완전히 믿을 수는 없으므로, 관측치를 기반으로 해당 확률을 수정해나간다는 내용이다.

결국 1번, 2번 설명이 사실은 같은 개념에 대한 것이지만 다르게 느껴졌던 이유는 서로 다른 부분에 집중해 설명했기 때문이다. 사후확률, 사전확률, likelihood의 관계를 명확히 파악하면 앞으로 이 개념 때문에 헷갈릴 일은 없을 것 같다.

## 출처
[다크프로그래머 베이지언 확률(Bayesian Probability)](https://darkpgmr.tistory.com/119)